<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>08-Upgrading Angular</title>
  <style>
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 id="upgrading-angular">Upgrading Angular</h1>
<p>Maintaining your applications’ compatibility with the latest Angular
versions is a crucial responsibility for any team working with this
robust platform. Angular adheres to a six-month release cycle, making it
necessary to continually update your projects. As of this writing,
Angular versions 12 and older are already unsupported. This means that
these versions no longer receive official patches, bug fixes, or
security updates from the Angular team. Using these unsupported versions
for a critical project could expose your application to potential
security vulnerabilities and degrade the overall quality of your
codebase due to unresolved bugs.</p>
<p>Updating your Angular version not only mitigates these risks but also
provides several benefits. These include gaining access to the latest
features and improvements, performance enhancements, and the most recent
security updates. Being on the cutting edge of Angular’s technology can
streamline your development process, facilitate better code practices,
and create a more robust and secure application.</p>
<p>However, staying current with Angular updates can seem daunting,
especially given the fear of breaking existing functionalities in the
upgrade process. Fortunately, the Angular team has made significant
strides in simplifying the update process, providing comprehensive
guidance and tools to help developers migrate their projects safely and
efficiently. By staying in tune with these updates, you’ll ensure your
applications remain robust, secure, and aligned with the best practices
in the ever-evolving Angular ecosystem.</p>
<h2 id="keep-on-top-of-things">Keep on Top of Things</h2>
<p>The key to a smooth transition between Angular versions lies in
regular, timely updates. Letting your project fall too far behind in
versions can complicate the update process significantly. For instance,
upgrading a project from Angular 5 directly to version 16 can be a
complex and potentially risky operation. Instead, the best practice is
to keep your project current or no more than two versions behind the
latest release (n-2).</p>
<p>Angular’s team prioritizes backward compatibility, meaning that most
updates don’t introduce breaking changes. When there is a need for such
changes, the Angular team typically provides two to three versions’
worth of advance warning. They use this time to highlight the upcoming
changes, often deprecating the soon-to-be-obsolete features but keeping
them functional until the scheduled removal. This procedure affords
developers the time to adapt their codebases progressively, reducing the
risk of an abrupt and potentially detrimental change.</p>
<p>Therefore, adopting a regular update schedule helps ensure that these
transitions are not overwhelming. Regularly updating Angular versions as
they’re released makes each upgrade a minor task, rather than a
monumental effort. This approach allows your team to incorporate the
latest features, fixes, and improvements into your project continually,
enhancing the overall performance and stability of your
applications.</p>
<p>Staying on top of Angular’s updates is a manageable task when you
don’t allow your project to lag too far behind. By doing so, you can
leverage the latest improvements while ensuring your applications remain
robust, secure, and compliant with modern development best
practices.</p>
<h2 id="follow-along">Follow Along</h2>
<p>You can utilize the very same steps outlined in this chapter to
upgrade your own Angular projects. Bear in mind, the procedure will
remain similar regardless of the specific versions you are migrating
between. We’ll be demonstrating an upgrade from version 12 to 16 -
spanning 4 major releases - which may represent the most ambitious leap
you’d want to undertake in a single stride without conducting extensive
and meticulous testing.</p>
<p>Remember, each version change may introduce changes that could
potentially affect your project. Therefore, although the steps are
similar across versions, it’s important to consider the scope of your
upgrade and plan for sufficient testing to ensure a seamless transition.
Take this guide as a blueprint, adapt it to the specific needs of your
project, and always prioritize careful testing for every upgrade
process.</p>
<h2 id="official-upgrade-guidance">Official Upgrade Guidance</h2>
<p>Did you know Angular provides official upgrade guidance? If you
haven’t visited the site, check out the <a
href="https://update.angular.io/">Angular Upgrade Guide</a> or visit the
raw URL: https://update.angular.io/</p>
<h2 id="my-project">My Project</h2>
<p>The application I’ll be upgrading is the showcase project from my
book and course on Ionic and Angular development. This is an Ionic
application, developed with a responsive design to function smoothly on
both desktop and mobile platforms.</p>
<p>Previously, I had updated the application to Angular 12 and then
paused its development for a period. Now, with Angular 16 being the
current version (as of the time of writing), I want to further update
the application to leverage Angular’s latest features.</p>
<p>For a glimpse of the application before the upgrade process, you can
visit its public GitHub repository at this link.</p>
<p>In order to keep the application in sync with Angular’s evolving
capabilities, I’ve resolved to upgrade it to Angular 16. This ensures
that the application continues to operate efficiently, making the most
of Angular’s cutting-edge features.</p>
<h3 id="angular-12.x-to-12.y">Angular 12.x to 12.y</h3>
<p>The first thing I did was ensure the project was on the latest
version of Angular 12.</p>
<p>It’s essential to note that the Angular CLI, during the update
process, expects to work on a clean repository, meaning that there
should be no uncommitted changes in your project. The reason behind this
is simple: should something go awry during the upgrade, it’s far easier
to revert to a clean state if all of your changes have been
committed.</p>
<p>Another critical point is to ensure that all your npm packages are
installed before you initiate the upgrade. The Angular CLI inspects your
node modules to identify what needs to be updated. If you don’t have all
your packages installed, it won’t have a clear picture of the updates
necessary. This could potentially lead to incomplete updates or version
mismatches, which could cause errors down the line.</p>
<p>In essence, a clean, up-to-date repository is a prerequisite to a
successful, painless upgrade. Prior to launching any upgrade, always
ensure your codebase is fully committed and your npm packages are
correctly installed.</p>
<p>After confirming a clean repo, I ran the following command:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ng</span> update @angular/cli@12 @angular/core@12</span></code></pre></div>
<p>The command is asking the Angular CLI to update both the Angular CLI
package and the Angular core package to version 12 in your project.</p>
<p>This is a common first step in the Angular update process, as you
would typically want to ensure your CLI and core framework are aligned
in terms of versioning, before moving onto other dependencies in your
project.</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">The</span> installed local Angular CLI version is older than the latest stable version.</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="ex">Installing</span> a temporary version to perform the update.</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="ex">✔</span> Package successfully installed.</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="ex">Workspace</span> extension with invalid name <span class="er">(</span><span class="ex">defaultProject</span><span class="kw">)</span> <span class="ex">found.</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="ex">Using</span> package manager: npm</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="ex">Collecting</span> installed dependencies...</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="ex">Found</span> 42 dependencies.</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="ex">Fetching</span> dependency metadata from registry...</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Updating</span> package.json with dependency @angular-devkit/build-angular @ <span class="st">&quot;12.2.18&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;12.2.13&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Updating</span> package.json with dependency @angular/cli @ <span class="st">&quot;12.2.18&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;12.2.13&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Updating</span> package.json with dependency @angular/compiler @ <span class="st">&quot;12.2.17&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;12.2.13&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Updating</span> package.json with dependency @angular/compiler-cli @ <span class="st">&quot;12.2.17&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;12.2.13&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Updating</span> package.json with dependency @angular/language-service @ <span class="st">&quot;12.2.17&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;12.2.13&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Updating</span> package.json with dependency @angular/common @ <span class="st">&quot;12.2.17&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;12.2.13&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Updating</span> package.json with dependency @angular/core @ <span class="st">&quot;12.2.17&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;12.2.13&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Updating</span> package.json with dependency @angular/forms @ <span class="st">&quot;12.2.17&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;12.2.13&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Updating</span> package.json with dependency @angular/platform-browser @ <span class="st">&quot;12.2.17&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;12.2.13&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Updating</span> package.json with dependency @angular/platform-browser-dynamic @ <span class="st">&quot;12.2.17&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;12.2.13&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Updating</span> package.json with dependency @angular/router @ <span class="st">&quot;12.2.17&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;12.2.13&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Updating</span> package.json with dependency typescript @ <span class="st">&quot;4.3.5&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;4.3.3&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="ex">UPDATE</span> package.json <span class="er">(</span><span class="ex">1841</span> bytes<span class="kw">)</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="ex">✔</span> Packages successfully installed.</span></code></pre></div>
<p>I specifically instructed the CLI to update to <span class="citation"
data-cites="angular/cli">@angular/cli</span> and <span class="citation"
data-cites="angular/core">@angular/core</span> version 12, which will
upgrade to the latest minor/revision of that major version.</p>
<p>Next, I committed the changes. As I said, Angular will not update on
an unclean working repo.</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">-am</span> <span class="st">&quot;Updated Angular to latest 12.x&quot;</span></span></code></pre></div>
<p>Not much happened because it was such a minor upgrade. The Angular
schematics didn’t detect any code changes required, which will not
always be the case, as I’m sure we’ll see. At this point, and after each
upgrade, it is a good idea to test your application to ensure everything
is working as expected. If you have automated tests, this step will be
much easier.</p>
<h2 id="angular-12-to-angular-13">Angular 12 to Angular 13</h2>
<p>A significant transition occurs when upgrading from Angular 12 to
Angular 13. This is the point where Ivy, Angular’s latest rendering
pipeline and view engine, becomes mandatory. Ivy was introduced as the
default rendering engine with Angular 9, providing improvements in
bundle size, debugging, build times, and type checking. While it was
optional from version 9 to 12, giving developers ample time to
transition, it was not until Angular 13 that the older View Engine was
fully retired.</p>
<p>As such, when you make the leap from Angular 12 to 13, you are also
making a commitment to Ivy. It is crucial to understand that after
Angular 12, there is no going back to the View Engine. This switch
carries both opportunities and responsibilities. You gain access to the
advancements that Ivy brings, but you also take on the task of ensuring
your codebase is compatible with this new engine.</p>
<p>Upgrading to Angular 13 implies embracing Ivy wholeheartedly, and as
such, you should test your application thoroughly to ensure that it
behaves as expected with the new rendering engine.</p>
<h3 id="upgrading-the-project-to-angular-13">Upgrading the Project to
Angular 13</h3>
<p>I upgraded the project to Angular 13 with the following command:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ng</span> update @angular/cli@13 @angular/core@13</span></code></pre></div>
<p>At this point I ran into my first snag. There were errors during the
package installation phase of the update.</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">The</span> installed Angular CLI version is outdated.</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="ex">Installing</span> a temporary Angular CLI versioned 13.3.11 to perform the update.</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="ex">✔</span> Package successfully installed.</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="ex">Using</span> package manager: <span class="st">&#39;npm&#39;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="ex">Collecting</span> installed dependencies...</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="ex">Found</span> 42 dependencies.</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="ex">Fetching</span> dependency metadata from registry...</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="ex">Updating</span> package.json with dependency @angular-devkit/build-angular @ <span class="st">&quot;13.3.11&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;12.2.18&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="ex">Updating</span> package.json with dependency @angular/cli @ <span class="st">&quot;13.3.11&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;12.2.18&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="ex">Updating</span> package.json with dependency @angular/compiler @ <span class="st">&quot;13.4.0&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;12.2.17&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="ex">Updating</span> package.json with dependency @angular/compiler-cli @ <span class="st">&quot;13.4.0&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;12.2.17&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="ex">Updating</span> package.json with dependency @angular/language-service @ <span class="st">&quot;13.4.0&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;12.2.17&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="ex">Updating</span> package.json with dependency typescript @ <span class="st">&quot;4.6.4&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;4.3.5&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="ex">Updating</span> package.json with dependency @angular/common @ <span class="st">&quot;13.4.0&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;12.2.17&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="ex">Updating</span> package.json with dependency @angular/core @ <span class="st">&quot;13.4.0&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;12.2.17&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="ex">Updating</span> package.json with dependency @angular/forms @ <span class="st">&quot;13.4.0&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;12.2.17&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="ex">Updating</span> package.json with dependency @angular/platform-browser @ <span class="st">&quot;13.4.0&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;12.2.17&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="ex">Updating</span> package.json with dependency @angular/platform-browser-dynamic @ <span class="st">&quot;13.4.0&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;12.2.17&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="ex">Updating</span> package.json with dependency @angular/router @ <span class="st">&quot;13.4.0&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;12.2.17&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="ex">UPDATE</span> package.json <span class="er">(</span><span class="ex">1832</span> bytes<span class="kw">)</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> ERR! code ERESOLVE</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> ERR! ERESOLVE could not resolve</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> ERR!</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> ERR! While resolving: at10dance@0.0.1</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> ERR! Found: @angular-devkit/build-angular@12.2.18</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> ERR! node_modules/@angular-devkit/build-angular</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> ERR! dev @angular-devkit/build-angular@<span class="st">&quot;~13.3.11&quot;</span> from the root project</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> ERR! peer @angular-devkit/build-angular@<span class="st">&quot;&gt;=0.800.0&quot;</span> from @ionic/angular-toolkit@2.2.0</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> ERR! node_modules/@ionic/angular-toolkit</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> ERR! dev @ionic/angular-toolkit@<span class="st">&quot;^2.1.1&quot;</span> from the root project</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> ERR!</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> ERR! Could not resolve dependency:</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> ERR! dev @angular-devkit/build-angular@<span class="st">&quot;~13.3.11&quot;</span> from the root project</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> ERR!</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> ERR! Conflicting peer dependency: @angular/compiler-cli@13.4.0</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> ERR! node_modules/@angular/compiler-cli</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> ERR! peer @angular/compiler-cli@<span class="st">&quot;^13.0.0 || ^13.3.0-rc.0&quot;</span> from @angular-devkit/build-angular@13.3.11</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> ERR! node_modules/@angular-devkit/build-angular</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> ERR! dev @angular-devkit/build-angular@<span class="st">&quot;~13.3.11&quot;</span> from the root project</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> ERR!</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> ERR! Fix the upstream dependency conflict, or retry</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> ERR! this command with <span class="at">--force</span> or <span class="at">--legacy-peer-deps</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> ERR! to accept an incorrect <span class="er">(</span><span class="ex">and</span> potentially broken<span class="kw">)</span> <span class="ex">dependency</span> resolution.</span></code></pre></div>
<p>Let’s unpack that and see what we can do about it. It appears that
there are some dependency problems. At this point, I cannot even run a
simple <code>npm install</code> without encountering these errors.</p>
<p>I temporarily sidestepped the errors by using
<code>npm install --legacy-peer-deps</code>. The
<code>--legacy-peer-deps</code> flag is a feature of npm that reverts to
the old peer dependencies algorithm from npm version 6. In npm v7, the
handling of peer dependencies was changed to automatically install them
(whereas in npm v6 and earlier they were not installed by default). This
means that, in npm v7, if there are incompatible peer dependencies, the
installation will fail.</p>
<p>The <code>--legacy-peer-deps</code> command circumvents this by
ignoring peer dependencies, allowing the install process to continue
even if there are incompatible versions. This flag can be handy as a
temporary solution when you’re trying to resolve conflicts, but it’s not
a long-term fix.</p>
<p>Why did it work? Essentially, this command worked because it bypassed
the stricter peer dependency resolutions that npm 7 employs and reverted
to the npm 6 way of handling things. This means it did not halt the
install process due to incompatible peer dependencies.</p>
<p>However, it’s important to note that using this flag as a long-term
solution is not advisable. It essentially silences the errors and
warnings, which are there for a reason: to help maintain the
compatibility and stability of your project. Ignoring peer dependencies
could lead to unpredictable behavior, subtle bugs, or even outright
application crashes if the dependencies rely on certain features or
behaviors of each other.</p>
<p>In general, it’s best to address the root cause of the conflict. This
could involve updating packages to versions that are compatible with
each other, seeking alternatives to certain packages, or reaching out to
package maintainers to address compatibility issues. Always consider the
<code>--legacy-peer-deps</code> option as a last resort, and even then,
only for short-term fixes.</p>
<h3 id="upgrading-ionic-and-other-dependencies">Upgrading Ionic and
Other Dependencies</h3>
<p>It appears I have some older versions of Ionic and Capacitor that
also need to be addressed. Though I had intended to ignore those for
this text, upgrading other critical dependencies is definitely a
scenario that should be addressed, so I’ll do that now. My guess is that
once these dependencies are updated, many of the other dependency issues
will be resolved also.</p>
<p>Fortunately, Ionic can be updated with the Angular CLI. I know that
Ionic is on version 7, but I’ll hold off until Angular is updated to
16.</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ng</span> update @ionic/angular@6</span></code></pre></div>
<p>At this point, my confidence level wasn’t high. You may be
experiencing that yourself, wondering how bad your project will be to
update. As you should always do with each major upgrade, I decided to
run the app to see how it worked. Fortunately, other than a few typos I
noticed, it worked as expected.</p>
<h2 id="angular-13-to-angular-14">Angular 13 to Angular 14</h2>
<p>After breathing a sigh of relief, I committed the repo’s changes and
then let the CLI upgrade from Angular 13 to Angular 14. Hopefully, there
won’t be any more surprises, but if so, I’ll deal with them as they
arise.</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ng</span> update @angular/cli@14 @angular/core@14</span></code></pre></div>
<p>Thankfully, this command completed without any of the dependency
issues. However, as you’ll see, this is the first update that required
Angular to make changes to my project itself.</p>
<pre><code>The installed Angular CLI version is outdated.
Installing a temporary Angular CLI versioned 14.2.12 to perform the update.
✔ Package successfully installed.
Using package manager: npm
Collecting installed dependencies...
Found 42 dependencies.
Fetching dependency metadata from registry...
Updating package.json with dependency @angular-devkit/build-angular @ &quot;14.2.12&quot; (was &quot;13.3.11&quot;)...
Updating package.json with dependency @angular/cli @ &quot;14.2.12&quot; (was &quot;13.3.11&quot;)...
Updating package.json with dependency @angular/compiler @ &quot;14.3.0&quot; (was &quot;13.4.0&quot;)...
Updating package.json with dependency @angular/compiler-cli @ &quot;14.3.0&quot; (was &quot;13.4.0&quot;)...
Updating package.json with dependency @angular/language-service @ &quot;14.3.0&quot; (was &quot;13.4.0&quot;)...
Updating package.json with dependency @angular/common @ &quot;14.3.0&quot; (was &quot;13.4.0&quot;)...
Updating package.json with dependency @angular/core @ &quot;14.3.0&quot; (was &quot;13.4.0&quot;)...
Updating package.json with dependency @angular/forms @ &quot;14.3.0&quot; (was &quot;13.4.0&quot;)...
Updating package.json with dependency @angular/platform-browser @ &quot;14.3.0&quot; (was &quot;13.4.0&quot;)...
Updating package.json with dependency @angular/platform-browser-dynamic @ &quot;14.3.0&quot; (was &quot;13.4.0&quot;)...
Updating package.json with dependency @angular/router @ &quot;14.3.0&quot; (was &quot;13.4.0&quot;)...
UPDATE package.json (1824 bytes)
✔ Packages successfully installed.
**Executing migrations of package &#39;@angular/cli&#39;**
❯ Remove &#39;defaultProject&#39; option from workspace configuration.
  The project to use will be determined from the current working directory.
UPDATE angular.json (5630 bytes)
  Migration completed.

❯ Remove &#39;showCircularDependencies&#39; option from browser and server builders.
  Migration completed.

❯ Replace &#39;defaultCollection&#39; option in workspace configuration with &#39;schematicCollections&#39;.
UPDATE angular.json (5647 bytes)
  Migration completed.

❯ Update Angular packages &#39;dependencies&#39; and &#39;devDependencies&#39; version prefix to &#39;^&#39; instead of &#39;~&#39;.
UPDATE package.json (1824 bytes)
✔ Packages installed successfully.
  Migration completed.

❯ Remove &#39;package.json&#39; files from library projects secondary entrypoints.
  Migration completed.

❯ Update TypeScript compilation target to &#39;ES2020&#39;.
UPDATE tsconfig.json (516 bytes)
  Migration completed.

**Executing migrations of package &#39;@angular/core&#39;**

❯ As of Angular version 13, `entryComponents` are no longer necessary.
UPDATE src/app/app.module.ts (584 bytes)
  Migration completed.

❯ In Angular version 14, the `pathMatch` property of `Routes` was updated to be a strict union of the two valid options: `&#39;full&#39;|&#39;prefix&#39;`.
  `Routes` and `Route` variables need an explicit type so TypeScript does not infer the property as the looser `string`.
  Migration completed.

❯ As of Angular version 14, Forms model classes accept a type parameter, and existing usages must be opted out to preserve backwards-compatibility.
  Migration completed.</code></pre>
<p>Most of these were informational. You can read the messages for
yourself, but there are a few things I want to point out.</p>
<ol type="1">
<li><strong>Changed the target in tsconfig.json from es2015 to
es2020:</strong> The target option in the tsconfig.json file tells the
TypeScript compiler which version of ECMAScript (the standard that
defines JavaScript) to use when transpiling your TypeScript code into
JavaScript. By changing the target from es2015 to es2020, Angular is
updating your project to use more modern JavaScript features that are
part of the ECMAScript 2020 specification. This can include features
like optional chaining, nullish coalescing, and more. This is consistent
with Angular dropping support for Internet Explorer.</li>
<li><strong>Removed entryComponents array from app.module.ts:</strong>
In Angular versions prior to 9, the entryComponents array in the
NgModule decorator was used to define components that are not found in
HTML templates (i.e., components that are dynamically loaded). With the
introduction of the Ivy compiler in Angular 9, this array is no longer
necessary because Ivy can compile and cache these components as needed,
so Angular removes it during the update process.</li>
<li><strong>Added “defaultProject”: “app” to angular.json:</strong> The
defaultProject option in the angular.json file specifies which project
should be built, served, etc., when no project name is provided in the
CLI command. By setting “defaultProject”: “app”, Angular is specifying
that the app project should be the default. This is particularly useful
in workspaces with multiple projects, as it allows you to run commands
like ng serve or ng build without specifying a project name.</li>
</ol>
<p>As before, I double-checked that the application was still
functional. Then, I committed the code and checked the behavior of the
application.</p>
<h2 id="angular-14-to-angular-15">Angular 14 to Angular 15</h2>
<p>Next, I upgraded from Angular 14 to Angular 15.</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ng</span> update @angular/cli@15 @angular/core@15</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="ex">The</span> installed Angular CLI version is outdated. Installing a temporary Angular CLI versioned 15.2.9 to perform the update.</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="ex">✔</span> Packages successfully installed.</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="ex">Using</span> package manager: npm</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="ex">Collecting</span> installed dependencies...</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="ex">Found</span> 42 dependencies.</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="ex">Fetching</span> dependency metadata from registry...</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Updating</span> package.json with dependency @angular-devkit/build-angular @ <span class="st">&quot;15.2.9&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;14.2.12&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Updating</span> package.json with dependency @angular/cli @ <span class="st">&quot;15.2.9&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;14.2.12&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Updating</span> package.json with dependency @angular/compiler @ <span class="st">&quot;15.2.9&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;14.3.0&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Updating</span> package.json with dependency @angular/compiler-cli @ <span class="st">&quot;15.2.9&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;14.3.0&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Updating</span> package.json with dependency @angular/language-service @ <span class="st">&quot;15.2.9&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;14.3.0&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Updating</span> package.json with dependency typescript @ <span class="st">&quot;4.9.5&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;4.6.4&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Updating</span> package.json with dependency @angular/common @ <span class="st">&quot;15.2.9&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;14.3.0&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Updating</span> package.json with dependency @angular/core @ <span class="st">&quot;15.2.9&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;14.3.0&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Updating</span> package.json with dependency @angular/forms @ <span class="st">&quot;15.2.9&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;14.3.0&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Updating</span> package.json with dependency @angular/platform-browser @ <span class="st">&quot;15.2.9&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;14.3.0&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Updating</span> package.json with dependency @angular/platform-browser-dynamic @ <span class="st">&quot;15.2.9&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;14.3.0&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Updating</span> package.json with dependency @angular/router @ <span class="st">&quot;15.2.9&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;14.3.0&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="ex">UPDATE</span> package.json <span class="er">(</span><span class="ex">1822</span> bytes<span class="kw">)</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="ex">✔</span> Packages successfully installed.</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="ex">**</span> Executing migrations of package <span class="st">&#39;@angular/cli&#39;</span> <span class="pp">**</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="ex">❯</span> Remove Browserslist configuration files that matches the Angular CLI default configuration.</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  <span class="ex">Migration</span> completed <span class="er">(</span><span class="ex">No</span> changes made<span class="kw">)</span><span class="bu">.</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="ex">❯</span> Remove exported <span class="kw">`</span><span class="ex">@angular/platform-server</span><span class="kw">`</span> <span class="kw">`</span><span class="ex">renderModule</span><span class="kw">`</span> method.</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  <span class="ex">The</span> <span class="kw">`</span><span class="ex">renderModule</span><span class="kw">`</span> method is now exported by the Angular CLI.</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  <span class="ex">Migration</span> completed <span class="er">(</span><span class="ex">No</span> changes made<span class="kw">)</span><span class="bu">.</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="ex">❯</span> Remove no longer needed require calls in Karma builder main file.</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="ex">UPDATE</span> src/test.ts <span class="er">(</span><span class="ex">459</span> bytes<span class="kw">)</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>  <span class="ex">Migration</span> completed <span class="er">(</span><span class="ex">1</span> file modified<span class="kw">)</span><span class="bu">.</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a><span class="ex">❯</span> Update TypeScript compiler <span class="kw">`</span><span class="ex">target</span><span class="kw">`</span> and set <span class="kw">`</span><span class="ex">useDefineForClassFields</span><span class="kw">`</span>.</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>  <span class="ex">These</span> changes are for IDE purposes as TypeScript compiler options <span class="kw">`</span><span class="ex">target</span><span class="kw">`</span> and <span class="kw">`</span><span class="ex">useDefineForClassFields</span><span class="kw">`</span> are set to <span class="kw">`</span><span class="ex">ES2022</span><span class="kw">`</span> and <span class="kw">`</span><span class="fu">false</span><span class="kw">`</span> respectively by the Angular CLI.</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>  <span class="ex">To</span> control ECMA version and features use the Browerslist configuration.</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a><span class="ex">UPDATE</span> tsconfig.json <span class="er">(</span><span class="ex">584</span> bytes<span class="kw">)</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>  <span class="ex">Migration</span> completed <span class="er">(</span><span class="ex">1</span> file modified<span class="kw">)</span><span class="bu">.</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a><span class="ex">❯</span> Remove options from <span class="st">&#39;angular.json&#39;</span> that are no longer supported by the official builders.</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>  <span class="ex">Migration</span> completed <span class="er">(</span><span class="ex">No</span> changes made<span class="kw">)</span><span class="bu">.</span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a><span class="ex">**</span> Executing migrations of package <span class="st">&#39;@angular/core&#39;</span> <span class="pp">**</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a><span class="ex">❯</span> In Angular version 15, the deprecated <span class="kw">`</span><span class="ex">relativeLinkResolution</span><span class="kw">`</span> config parameter of the Router is removed.</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>  <span class="ex">This</span> migration removes all <span class="kw">`</span><span class="ex">relativeLinkResolution</span><span class="kw">`</span> fields from the Router config objects.</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a><span class="ex">UPDATE</span> src/app/app-routing.module.ts <span class="er">(</span><span class="ex">788</span> bytes<span class="kw">)</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>  <span class="ex">Migration</span> completed <span class="er">(</span><span class="ex">1</span> file modified<span class="kw">)</span><span class="bu">.</span></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a><span class="ex">❯</span> Since Angular v15, the <span class="kw">`</span><span class="ex">RouterLink</span><span class="kw">`</span> contains the logic of the <span class="kw">`</span><span class="ex">RouterLinkWithHref</span><span class="kw">`</span> directive.</span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>  <span class="ex">This</span> migration replaces all <span class="kw">`</span><span class="ex">RouterLinkWithHref</span><span class="kw">`</span> references with <span class="kw">`</span><span class="ex">RouterLink</span><span class="kw">`</span>.</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>  <span class="ex">Migration</span> completed <span class="er">(</span><span class="ex">No</span> changes made<span class="kw">)</span><span class="bu">.</span></span></code></pre></div>
<p>That was a lot, but reviewing the changes, it didn’t do much. One
thing worth pointing out is a change it made to tsconfig.json. It added
<code>"useDefineForClassFields": false</code> to the end of the
compilerOptions section.</p>
<p>The <code>"useDefineForClassFields": false</code> setting in
TypeScript ensures that class fields are initialized after the
constructor is called. This is important for Angular components that use
dependency injection in the constructor and initialize class fields with
values that depend on these injected dependencies.</p>
<p>For example, consider an Angular component that uses a value from the
ActivatedRoute service to initialize a class field:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>@<span class="fu">Component</span>({</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  selector<span class="op">:</span> <span class="st">&#39;my-component&#39;</span><span class="op">,</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  template<span class="op">:</span> <span class="vs">`{{ name }}`</span><span class="op">,</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="im">export</span> <span class="kw">class</span> MyComponent {</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  name <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="fu">getName</span>()<span class="op">;</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">constructor</span>(<span class="kw">private</span> route<span class="op">:</span> ActivatedRoute) {}</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">getName</span>()<span class="op">:</span> <span class="dt">string</span> {</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">this</span><span class="op">.</span><span class="at">route</span><span class="op">.</span><span class="at">snapshot</span><span class="op">.</span><span class="at">paramMap</span><span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;name&#39;</span>)<span class="op">;</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>With <code>"useDefineForClassFields": true</code>, TypeScript would
try to initialize name before route is defined, causing an error. By
setting <code>"useDefineForClassFields": false</code>, TypeScript
initializes name after the constructor is called, ensuring route is
defined when getName is called.</p>
<p>Had the Angular team not made this decision, many existing Angular
apps would break when upgraded to Angular 15 and its updated version of
TypeScript.</p>
<p>After that, I once again reviewed the application’s behavior. When I
was satisfied, I committed the code and moved on.</p>
<h2 id="angular-15-to-angular-16">Angular 15 to Angular 16</h2>
<p>Finally, I asked the CLI to upgrade from Angular 15 to Angular
16.</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ng</span> update @angular/cli@16 @angular/core@16</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="ex">The</span> installed Angular CLI version is outdated.</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="ex">Installing</span> a temporary Angular CLI versioned 16.1.4 to perform the update.</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="ex">✔</span> Packages successfully installed.</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="ex">Using</span> package manager: npm</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="ex">Collecting</span> installed dependencies...</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="ex">Found</span> 42 dependencies.</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="ex">Fetching</span> dependency metadata from registry...</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="ex">Updating</span> package.json with dependency @angular-devkit/build-angular @ <span class="st">&quot;16.1.4&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;15.2.9&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="ex">Updating</span> package.json with dependency @angular/cli @ <span class="st">&quot;16.1.4&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;15.2.9&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="ex">Updating</span> package.json with dependency @angular/compiler @ <span class="st">&quot;16.1.5&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;15.2.9&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="ex">Updating</span> package.json with dependency @angular/compiler-cli @ <span class="st">&quot;16.1.5&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;15.2.9&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="ex">Updating</span> package.json with dependency @angular/language-service @ <span class="st">&quot;16.1.5&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;15.2.9&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="ex">Updating</span> package.json with dependency @angular/common @ <span class="st">&quot;16.1.5&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;15.2.9&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="ex">Updating</span> package.json with dependency @angular/core @ <span class="st">&quot;16.1.5&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;15.2.9&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="ex">Updating</span> package.json with dependency @angular/forms @ <span class="st">&quot;16.1.5&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;15.2.9&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="ex">Updating</span> package.json with dependency @angular/platform-browser @ <span class="st">&quot;16.1.5&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;15.2.9&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="ex">Updating</span> package.json with dependency @angular/platform-browser-dynamic @ <span class="st">&quot;16.1.5&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;15.2.9&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="ex">Updating</span> package.json with dependency @angular/router @ <span class="st">&quot;16.1.5&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;15.2.9&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="ex">Updating</span> package.json with dependency zone.js @ <span class="st">&quot;0.13.1&quot;</span> <span class="er">(</span><span class="ex">was</span> <span class="st">&quot;0.11.4&quot;</span><span class="kw">)</span><span class="ex">...</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="ex">UPDATE</span> package.json <span class="er">(</span><span class="ex">1822</span> bytes<span class="kw">)</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="ex">✔</span> Packages successfully installed.</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="ex">**Executing</span> migrations of package <span class="st">&#39;@angular/cli&#39;</span>:<span class="pp">**</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="ex">❯</span> Remove <span class="st">&#39;defaultProject&#39;</span> option from workspace configuration.</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  <span class="ex">The</span> project to use will be determined from the current working directory.</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>  <span class="ex">Migration</span> completed <span class="er">(</span><span class="ex">No</span> changes made<span class="kw">)</span><span class="bu">.</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a><span class="ex">❯</span> Replace removed <span class="st">&#39;defaultCollection&#39;</span> option in workspace configuration with <span class="st">&#39;schematicCollections&#39;</span>.</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>  <span class="ex">Migration</span> completed <span class="er">(</span><span class="ex">No</span> changes made<span class="kw">)</span><span class="bu">.</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a><span class="ex">❯</span> Update the <span class="st">&#39;@angular-devkit/build-angular:server&#39;</span> builder configuration to disable <span class="st">&#39;buildOptimizer&#39;</span> for non optimized builds.</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>  <span class="ex">Migration</span> completed <span class="er">(</span><span class="ex">No</span> changes made<span class="kw">)</span><span class="bu">.</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a><span class="ex">**Executing</span> migrations of package <span class="st">&#39;@angular/core&#39;</span>:<span class="pp">**</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a><span class="ex">❯</span> In Angular version 15.2, the guard and resolver interfaces <span class="er">(</span><span class="ex">CanActivate,</span> Resolve, etc<span class="kw">)</span> <span class="ex">were</span> deprecated.</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>  <span class="ex">This</span> migration removes imports and <span class="st">&#39;implements&#39;</span> clauses that contain them.</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>  <span class="ex">Migration</span> completed <span class="er">(</span><span class="ex">No</span> changes made<span class="kw">)</span><span class="bu">.</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a><span class="ex">❯</span> As of Angular v16, the <span class="kw">`</span><span class="ex">moduleId</span><span class="kw">`</span> property of <span class="kw">`</span><span class="ex">@Component</span><span class="kw">`</span> is deprecated as it no longer has any effect.</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>  <span class="ex">Migration</span> completed <span class="er">(</span><span class="ex">No</span> changes made<span class="kw">)</span><span class="bu">.</span></span></code></pre></div>
<p>It didn’t make any code or configuration changes to my project, which
is understandable. While Angular 16 added a lot of functionality, it
didn’t remove or change anything major. However, I do want to point out
one very important thing that will be an issue in the next release or
two. Specifically, this message:</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">❯</span> In Angular version 15.2, the guard and resolver interfaces <span class="er">(</span><span class="ex">CanActivate,</span> Resolve, etc<span class="kw">)</span> <span class="ex">were</span> deprecated.</span></code></pre></div>
<p>The shift from class-based to functional interfaces for guards and
resolvers in Angular is part of a broader industry trend towards
functional programming, which offers several advantages:</p>
<ol type="1">
<li><strong>Testability:</strong> Functional code is generally easier to
test because it doesn’t rely on external state. Each function is
self-contained, taking inputs and producing outputs without side
effects.</li>
<li><strong>Simplicity:</strong> Functional interfaces are typically
simpler and more straightforward than class-based interfaces. They don’t
require the new keyword to create an instance and don’t have the
<code>this</code> context, which can be a source of confusion.</li>
<li><strong>Tree-shaking:</strong> Functional code is more amenable to
tree-shaking, a process used by modern bundlers to eliminate unused code
and reduce the size of the final bundle. This can lead to smaller,
faster applications.</li>
</ol>
<p>In the context of Angular, the shift to functional interfaces for
guards and resolvers means that you can now use simple functions instead
of classes to define your guards and resolvers. This can make your code
cleaner, easier to understand, and potentially more efficient.</p>
<p>However, it’s important to note that while the class-based interfaces
are deprecated, they will continue to work for some time to ensure
backward compatibility. You should plan to migrate to the new functional
interfaces at your earliest convenience to take advantage of their
benefits and stay up-to-date with Angular’s evolution.</p>
<p>I’ll talk more about that in a later chapter.</p>
<h2 id="a-note-on-the-angular-cli">A Note on the Angular CLI</h2>
<p>You may have noticed that each Angular update started with a message
about the installed CLI being outdated. My globally-installed version is
16.1.4, which is the latest version available at this time. The message
displayed during the update process was because the Angular CLI detected
a version mismatch between the currently installed CLI and the targeted
version of Angular. Ultimately, it doesn’t really matter. The Angular
CLI and <code>ng update</code> will do the right thing.</p>
<h2 id="summary">Summary</h2>
<p>In this chapter, we explored the importance of regularly updating
your Angular projects, the benefits it brings, as well as the potential
pitfalls if neglected.</p>
<h3
id="regularly-updating-your-angular-projects-is-critical-for-a-number-of-reasons">Regularly
updating your Angular projects is critical for a number of reasons:</h3>
<ol type="1">
<li><strong>Security:</strong> Outdated versions can have unresolved
security vulnerabilities, leaving your application open to potential
threats.</li>
<li><strong>Support:</strong> As of this writing, Angular versions 12
and older are already unsupported. This means if your application is on
an unsupported version, you may face challenges getting help with bugs
or issues.</li>
<li><strong>Access to New Features:</strong> Each new version of Angular
brings a host of improvements, enhancements, and new features that can
make your development process smoother and your application more
efficient and performant.</li>
<li><strong>Performance Enhancements:</strong> Newer versions of Angular
often come with optimizations and performance enhancements, which can
improve the overall performance and user experience of your
applications.</li>
</ol>
<p>However, there are potential pitfalls if you let your project fall
too far behind:</p>
<ol type="1">
<li><strong>Complex Upgrade Process:</strong> Upgrading across multiple
major versions at once can become complex and time-consuming, often
requiring extensive testing and debugging.</li>
<li><strong>Deprecated Features:</strong> Older versions may rely on
features or APIs that are deprecated in newer versions. When these are
removed, it can cause breaking changes in your application.</li>
<li><strong>Package Compatibility Issues:</strong> Newer Angular
versions may have incompatibilities with older versions of certain
packages, which can lead to version conflicts and can make the update
process complicated.</li>
</ol>
<p>By regularly updating your Angular applications - ideally staying
current or no more than n-2 versions behind - you can mitigate these
challenges. Angular’s iterative approach to updates, with few breaking
changes from release to release, makes this a manageable task. With
strategic version control and frequent testing, you can take advantage
of the latest Angular offerings while keeping your projects secure and
performant.</p>
<p>As you navigate the update process, remember to always have a clean
repository, ensure your npm packages are installed, and have a
compatible version of Angular CLI. While there are workarounds to
package conflicts, like the <code>npm install --legacy-peer-deps</code>
command, these are not long-term solutions and it’s crucial to resolve
these issues promptly.</p>
<p>Finally, using appropriate versions of associated technologies, like
I did with Ionic, that are compatible with your Angular version ensures
smoother functioning of your application. It’s always recommended to
refer to the official documentation to keep abreast with these
specifications.</p>
<p>Keeping your Angular projects updated is an essential part of
maintaining a secure, efficient, and highly performant application that
can continue to grow and evolve with the ever-changing web development
landscape.</p>
<p>While your upgrade experience might differ from mine, I hope the
information has been helpful. Wishing you every success in your own
endeavors.</p>
</body>
</html>
