<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>09-Standalone Components</title>
  <style>
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 id="standalone-components">Standalone Components</h1>
<p>Introduced as a developer preview in Angular 15.2, standalone
components in Angular mark a significant step towards simplifying the
development process. They eliminate the need for <code>NgModule</code>s,
streamlining the developer experience and making the code more concise
and clear. This new approach allows developers to specify dependencies
directly within components, without having to navigate through
<code>NgModule</code>s.</p>
<h2 id="scam-pattern">SCAM Pattern</h2>
<p>Prior to standalone components, many Angular developers turned to a
pattern that became known as SCAM. The SCAM pattern in Angular stands
for Single Component Angular Module. It’s a design pattern where each
Angular component is paired with its own Angular module.</p>
<p>The SCAM pattern emerged as a response to some of the complexities
and challenges associated with traditional Angular module organization.
In a typical Angular application, components, directives, and pipes are
often grouped into shared or feature modules. While this approach has
its advantages, it can lead to challenges in understanding dependencies,
promoting reusability, and optimizing performance.</p>
<p>The SCAM pattern addresses these challenges by providing a clear and
concise way to organize components and their dependencies. It aligns
with modern development practices and the trend towards more modular and
maintainable code.</p>
<h2 id="introduction-to-standalone-components">Introduction to
Standalone Components</h2>
<p>Standalone Components in Angular are a more recent development that
aims to simplify the structure of Angular applications by reducing the
reliance on NgModules. While the SCAM pattern provided a way to
encapsulate components with their dependencies, Standalone Components
take this concept further by eliminating the need for additional modules
altogether.</p>
<p>Another thing that makes standalone components particularly appealing
is their ability to be adopted incrementally. Existing applications can
embrace this new style without any breaking changes, providing a smooth
transition path. Moreover, standalone components are compatible with
existing <code>NgModule</code>-based libraries and dependencies,
allowing developers to take full advantage of the existing Angular
ecosystem.</p>
<p>The introduction of standalone components also brings enhancements to
routing and lazy loading. The updated router APIs are designed to work
seamlessly with standalone components, simplifying common lazy-loading
scenarios and removing the need for an <code>NgModule</code>. This not
only makes the code cleaner but also enhances the application’s
performance.</p>
<h1 id="eliminates-app.module.ts">Eliminates app.module.ts</h1>
<p>Bootstrapping an Angular application has also become more
straightforward with standalone components. Developers can now bootstrap
without any <code>NgModule</code>, using a standalone component as the
root. This further simplifies the application structure and reduces
boilerplate code.</p>
<p>Library authors will find standalone components beneficial as well.
They can export standalone components, directives, and pipes, offering
more flexibility in structuring and distributing their libraries. This
pattern is useful for creating sets of cooperating directives that work
together to form a logical unit, such as a carousel widget.</p>
<p>Standalone components also introduce new ways of configuring
dependency injection. The concept of environment injectors and
standalone injectors provides more control and flexibility over how
dependencies are managed. This new configuration pattern supports more
advanced usage patterns and ensures that standalone components are truly
self-contained, preventing any “leakage” of implementation details into
the rest of the application.</p>
<h1 id="upgrading-your-angular-app-to-standalone">Upgrading Your Angular
App to Standalone</h1>
<p>If you want to migrate your <code>NgModule</code>-based app to
Standalone, the Angular CLI provides a migration schematic to do most of
the work for you, which I will demonstrate here. It’s not foolproof, as
we’ll soon see.</p>
<p>I will continue the application upgrade from the prior chapter by
migrating the entire app to standalone components. I’ll show the steps,
but only some of the resulting code, where it helps to illustrate what’s
going on.</p>
<h2 id="preparing-for-migration">Preparing for Migration</h2>
<p>If you want to follow along with your own app, ensure that your
project is using Angular 15.2.0 or later. I just upgraded mine to 16 in
the last chapter, so I’ve got that covered. Make sure the project builds
without any compilation errors and that you have no uncommitted changes.
It also helps to start with a clean branch, which I’ll do here to save
all my work.</p>
<pre class="shell"><code>❯ git checkout -b standalone-migration
Switched to a new branch &#39;standalone-migration&#39;</code></pre>
<h2 id="running-the-schematic">Running the Schematic</h2>
<p>I initiated the migration by running the following command, which
offered a few options. This is a multi-step process, and I’ll show each
step and some of what changed. I selected the first option to convert
all components, directives, and pipes to standalone.</p>
<pre class="shell"><code>❯ ng generate @angular/core:standalone

? Choose the type of migration: (Use arrow keys)
❯ Convert all components, directives and pipes to standalone
  Remove unnecessary NgModule classes
  Bootstrap the application using standalone APIs

? Which path in your project should be migrated? (./)

    🎉 Automated migration step has finished! 🎉
    IMPORTANT! Please verify manually that your application builds and behaves as expected.
    See https://angular.io/guide/standalone-migration for more information.
UPDATE src/app/home/home.page.ts (402 bytes)
UPDATE src/app/student-info/student-info.page.ts (2390 bytes)
UPDATE src/app/roster/roster.page.ts (3071 bytes)
UPDATE src/app/home/home.module.ts (423 bytes)
UPDATE src/app/student-info/student-info.module.ts (521 bytes)
UPDATE src/app/roster/roster.module.ts (437 bytes)
UPDATE src/app/app.component.spec.ts (2218 bytes)
UPDATE src/app/home/home.page.spec.ts (636 bytes)
UPDATE src/app/roster/roster.page.spec.ts (650 bytes)
UPDATE src/app/student-info/student-info.page.spec.ts (686 bytes)</code></pre>
<h3 id="review-a-change">Review a Change</h3>
<p>Let’s take a look at one of the Angular components to see what the
migration scripts did. I’ll show only the semantically meaningful
changes to the Roster page component.</p>
<h4 id="before">Before:</h4>
<div class="sourceCode" id="cb3"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>@<span class="fu">Component</span>({</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  selector<span class="op">:</span> <span class="st">&#39;app-student-info&#39;</span><span class="op">,</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  templateUrl<span class="op">:</span> <span class="st">&#39;./student-info.page.html&#39;</span><span class="op">,</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  styleUrls<span class="op">:</span> [<span class="st">&#39;./student-info.page.scss&#39;</span>]<span class="op">,</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<h4 id="after">After:</h4>
<div class="sourceCode" id="cb4"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>@<span class="fu">Component</span>({</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    selector<span class="op">:</span> <span class="st">&#39;app-student-info&#39;</span><span class="op">,</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    templateUrl<span class="op">:</span> <span class="st">&#39;./student-info.page.html&#39;</span><span class="op">,</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    styleUrls<span class="op">:</span> [<span class="st">&#39;./student-info.page.scss&#39;</span>]<span class="op">,</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    standalone<span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    imports<span class="op">:</span> [</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>        NgIf<span class="op">,</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>        IonicModule<span class="op">,</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>        FormsModule<span class="op">,</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>        AsyncPipe<span class="op">,</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>        JsonPipe<span class="op">,</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    ]<span class="op">,</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>At first, you may be wondering how adding <em>more</em> code is a
good thing. Remember that we’ll be removing an entire
<code>NgModule</code>, so please trust the process for now.</p>
<p>The migration added the <code>standalone: true</code> property to the
component’s metadata, marking it as a standalone component. An
<code>imports</code> array was also added, listing the dependencies that
this component relies on, including the newly imported modules and
directives. Standalone components need to tell Angular about other
components and modules they plan to use. The tradeoff is that by adding
these imports here explicitly, Angular’s tree-shaking is able to remove
unused components more intelligently, potentially leading to smaller
bundle sizes. Some of these would have been imported into the page’s
<code>ngModule</code> or in app.module.ts, but those will both be
deleted soon.</p>
<p>After that, I ran the application and tests to ensure everything was
working as expected. I’m probably being over cautious, but I also
committed the changes to my Git repository before taking the next
step.</p>
<h3 id="step-2-remove-unnecessary-ngmodule-classes">Step 2: Remove
Unnecessary NgModule Classes</h3>
<p>Next, I needed to remove unnecessary NgModule classes. With
standalone components, I don’t need any of the individual component
modules, nor do I need their individual routing modules. However, I do
need to make sure that each page’s routes are moved to the app-routing
module.</p>
<p>Ever the optimist, I tried running the migration script again, this
time selecting the second option.</p>
<pre class="shell"><code>❯  ng generate @angular/core:standalone

? Choose the type of migration:
  Convert all components, directives and pipes to standalone
❯ Remove unnecessary NgModule classes
  Bootstrap the application using standalone APIs
? Which path in your project should be migrated? ./
  🎉 Automated migration step has finished! 🎉
  IMPORTANT! Please verify manually that your application builds and behaves as expected.
  See https://angular.io/guide/standalone-migration for more information.
Nothing to be done.</code></pre>
<p>This was unexpected until I thought it about it some. As I said, I
tend to use the SCAM pattern on my Angular apps and this app was no
exception. Apparently the Angular CLI migration doesn’t know how to do
that, which is a little disappointing.</p>
<p>The meant I had to do this manually. As I said before, I needed to
move each page’s routing into app-routing.module.ts and then I could
simply delete the modules for each component.</p>
<h4 id="routing">Routing</h4>
<p>Let’s take a look at the app-routing before and after.</p>
<p><strong>Before:</strong></p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  path<span class="op">:</span> <span class="st">&#39;home&#39;</span><span class="op">,</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  loadChildren<span class="op">:</span> () <span class="kw">=&gt;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span>(<span class="st">&#39;./home/home.module&#39;</span>)<span class="op">.</span><span class="fu">then</span>((m) <span class="kw">=&gt;</span> m<span class="op">.</span><span class="at">HomePageModule</span>)<span class="op">,</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>}<span class="op">,</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  path<span class="op">:</span> <span class="st">&#39;student-info&#39;</span><span class="op">,</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  loadChildren<span class="op">:</span> () <span class="kw">=&gt;</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span>(<span class="st">&#39;./student-info/student-info.module&#39;</span>)<span class="op">.</span><span class="fu">then</span>(</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>      (m) <span class="kw">=&gt;</span> m<span class="op">.</span><span class="at">StudentInfoPageModule</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>}<span class="op">,</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  path<span class="op">:</span> <span class="st">&#39;roster&#39;</span><span class="op">,</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  loadChildren<span class="op">:</span> () <span class="kw">=&gt;</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span>(<span class="st">&#39;./roster/roster.module&#39;</span>)<span class="op">.</span><span class="fu">then</span>((m) <span class="kw">=&gt;</span> m<span class="op">.</span><span class="at">RosterPageModule</span>)<span class="op">,</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>}<span class="op">,</span></span></code></pre></div>
<p><strong>After:</strong></p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  path<span class="op">:</span> <span class="st">&#39;home&#39;</span><span class="op">,</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  loadComponent<span class="op">:</span> () <span class="kw">=&gt;</span> <span class="im">import</span>(<span class="st">&#39;./home/home.page&#39;</span>)<span class="op">.</span><span class="fu">then</span>((m) <span class="kw">=&gt;</span> m<span class="op">.</span><span class="at">HomePage</span>)<span class="op">,</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>}<span class="op">,</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  path<span class="op">:</span> <span class="st">&#39;student-info&#39;</span><span class="op">,</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  children<span class="op">:</span> [</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>      path<span class="op">:</span> <span class="st">&#39;:id&#39;</span><span class="op">,</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>      loadComponent<span class="op">:</span> () <span class="kw">=&gt;</span> <span class="im">import</span>(<span class="st">&#39;./student-info/student-info.page&#39;</span>)<span class="op">.</span><span class="fu">then</span>((m) <span class="kw">=&gt;</span> m<span class="op">.</span><span class="at">StudentInfoPage</span>)<span class="op">,</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>}<span class="op">,</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  path<span class="op">:</span> <span class="st">&#39;roster&#39;</span><span class="op">,</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  loadComponent<span class="op">:</span> () <span class="kw">=&gt;</span> <span class="im">import</span>(<span class="st">&#39;./roster/roster.page&#39;</span>)<span class="op">.</span><span class="fu">then</span>((m) <span class="kw">=&gt;</span> m<span class="op">.</span><span class="at">RosterPage</span>)<span class="op">,</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>}<span class="op">,</span></span></code></pre></div>
<p>Initially, I was leveraging the <code>loadChildren</code> method to
lazily load entire modules. By replacing those with standalone
components, that was no longer necessary, or even possible. So, I
transitioned to the <code>loadComponent</code> field, which has
essentially the same syntax. You import the component directly by file
name, which returns a promise. Once it’s loaded, you can grab the
component itself in a type-safe manager in the callback.</p>
<p>It’s a subtle change, but it significantly improved the code’s
readability, ensuring that future developers can navigate it with
ease.</p>
<p>Once I did that, I was able to delete all the existing components’
modules and run the app again.</p>
<h4 id="ionic-6.x-warning">Ionic 6.x Warning</h4>
<p>This is a book about Angular, not Ionic. That said, I do want to
point out one additional change I needed to make, given that the app in
question uses Ionic components.</p>
<p>Ionic 6 supported standalone components through the use of an
<code>environment</code> injector. Without that, an Angular app using
Ionic with standalone components wouldn’t work. The symptom is that the
app won’t render anything but a white screen.</p>
<p>Conveniently, the fix is printed right in the browser console.</p>
<p>To fix it, you simply add a couple of lines of code.</p>
<p><strong>Before: app.component.ts</strong></p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">constructor</span>(<span class="kw">private</span> platform<span class="op">:</span> Platform<span class="op">,</span> <span class="kw">private</span> students<span class="op">:</span> StudentsService) {</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">this</span><span class="op">.</span><span class="fu">initializeApp</span>()<span class="op">;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>After: app.component.ts</strong></p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">constructor</span>(<span class="kw">public</span> environmentInjector<span class="op">:</span> EnvironmentInjector<span class="op">,</span> <span class="kw">private</span> platform<span class="op">:</span> Platform<span class="op">,</span> <span class="kw">private</span> students<span class="op">:</span> StudentsService) {</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">this</span><span class="op">.</span><span class="fu">initializeApp</span>()<span class="op">;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>I added the <code>EnvironmentInjector</code> object into my app
component’s constructor. Then, in the app component’s HTML file, I used
Angular data binding to insert it into the
<code>&lt;ion-router-outlet&gt;</code>.</p>
<p><strong>Before: app.component.html</strong></p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode html"><code class="sourceCode html"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;ion-router-outlet</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="ot">  id=</span><span class="st">&quot;main-content&quot;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="kw">&gt;&lt;/ion-router-outlet&gt;</span></span></code></pre></div>
<p><strong>After: app.component.html</strong></p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode html"><code class="sourceCode html"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;ion-router-outlet</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="ot">  id=</span><span class="st">&quot;main-content&quot;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="ot">  [environmentInjector]=</span><span class="st">&quot;environmentInjector&quot;</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="kw">&gt;&lt;/ion-router-outlet&gt;</span></span></code></pre></div>
<p><em>Note: Ionic 7 solves this problem entirely by supporting
standalone components natively.</em></p>
<h3 id="step-3-bootstrap-the-project-using-standalone-apis">Step 3:
Bootstrap the Project Using Standalone APIs</h3>
<p>As the final step, I bootstrapped the project using standalone APIs.
That meant running the schematic one last time.</p>
<pre class="shell"><code>❯ npx ng generate @angular/core:standalone
? Choose the type of migration:
  Convert all components, directives and pipes to standalone
  Remove unnecessary NgModule classes
❯ Bootstrap the application using standalone APIs
? Which path in your project should be migrated? ./
    🎉 Automated migration step has finished! 🎉
    IMPORTANT! Please verify manually that your application builds and behaves as expected.
    See https://angular.io/guide/standalone-migration for more information.
DELETE src/app/app.module.ts
UPDATE src/main.ts (995 bytes)
UPDATE src/app/app.component.ts (1159 bytes)
UPDATE src/app/app.component.spec.ts (2198 bytes)</code></pre>
<p>Let’s review what it did.</p>
<p><strong>Before: app.component.ts</strong></p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>@<span class="fu">Component</span>({</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>   selector<span class="op">:</span> <span class="st">&#39;app-root&#39;</span><span class="op">,</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>   templateUrl<span class="op">:</span> <span class="st">&#39;app.component.html&#39;</span><span class="op">,</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>   styleUrls<span class="op">:</span> [<span class="st">&#39;app.component.scss&#39;</span>]<span class="op">,</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p><strong>After: app.component.ts</strong></p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>@<span class="fu">Component</span>({</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>   selector<span class="op">:</span> <span class="st">&#39;app-root&#39;</span><span class="op">,</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>   templateUrl<span class="op">:</span> <span class="st">&#39;app.component.html&#39;</span><span class="op">,</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>   styleUrls<span class="op">:</span> [<span class="st">&#39;app.component.scss&#39;</span>]<span class="op">,</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>   standalone<span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>   imports<span class="op">:</span> [</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>       IonicModule<span class="op">,</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>       NgFor<span class="op">,</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>       RouterLinkActive<span class="op">,</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>       RouterLink<span class="op">,</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>   ]<span class="op">,</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>In the <code>app.component.ts</code>, the schematic added the
<code>standalone: true</code> property to the <code>@Component</code>
decorator. Moreover, the necessary dependencies like
<code>IonicModule</code>, <code>NgFor</code>,
<code>RouterLinkActive</code>, and <code>RouterLink</code> were moved
directly into the component’s <code>imports</code> array.</p>
<p>The schematic then deleted the <code>app.module.ts</code> file
completely.</p>
<p><strong>Before: main.ts</strong></p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">platformBrowserDynamic</span>()</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">bootstrapModule</span>(AppModule)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">catch</span>((err) <span class="kw">=&gt;</span> <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(err))<span class="op">;</span></span></code></pre></div>
<p><strong>After: main.ts</strong></p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bootstrapApplication</span>(AppComponent<span class="op">,</span> {</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  providers<span class="op">:</span> [</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">importProvidersFrom</span>(</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>      BrowserModule<span class="op">,</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>      IonicModule<span class="op">.</span><span class="fu">forRoot</span>()<span class="op">,</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>      AppRoutingModule<span class="op">,</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>      provide<span class="op">:</span> RouteReuseStrategy<span class="op">,</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>      useClass<span class="op">:</span> IonicRouteStrategy<span class="op">,</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>})<span class="op">.</span><span class="fu">catch</span>((err) <span class="kw">=&gt;</span> <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(err))<span class="op">;</span></span></code></pre></div>
<p>In <code>main.ts</code>, rather than using the conventional
<code>bootstrapModule</code> method to start the application with a
module, the schematic changed it to call the
<code>bootstrapApplication</code> function to initiate the app directly.
Required providers and configurations were directly imported and
integrated during this bootstrapping phase.</p>
<h3 id="does-it-work">Does it work?</h3>
<p>Automatic upgrade code is great, but to be useful, it still has to
work properly. I fired up the app with <code>npm start</code> and
quickly ran through its functionality. It all worked as expected.</p>
<p>Satisfied with the results of the migration, I committed the code and
pushed to my repository on GitHub.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Migrating to standalone components in Angular was a significant
transformation, but by taking a methodical approach, I ensured a
successful migration. Regularly committing changes, running tests, and
verifying the application’s functionality at each stage gave me
confidence in the process. I’m pleased with the result, and I feel that
my codebase is now more streamlined and maintainable, aligning with
modern development practices.</p>
</body>
</html>
